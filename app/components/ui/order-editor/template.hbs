<div class="row">
  <div class="col stretch">
    <span class="company">
      {{model.location.company.name}}
    </span>
    <span class="locationInfo">
      {{model.location.id}} - {{model.location.name}}
    </span>

    {{#if model.isPurchaseOrder}}
      {{ui/order-editor/notification-status status=model.notificationState}}
    {{/if}}

    <div class="row orderInfo">
      <span class="title">
        {{if isSalesOrder 'Invoice' 'Purchase Order'}}
      </span>
      <span class="salesOrderNumber">
        {{model.orderNumber}}
      </span>
      <div class="row stretch toolbar">
        <div class="row">
          {{#if model.isPurchaseOrder}}
            {{ui/icon-button
                type='send'
                class='send'
                flat=true
                color=colors.DARK_GREY
                size=1.2
                action=emailOrder}}
          {{/if}}

        </div>
        <div class="row">
          {{ui/icon-button
              type='local_printshop'
              class='print'
              flat=true
              color=colors.DARK_GREY
              size=1.2
              action=(action 'printOrder')}}
        </div>
        <div class="row">
          {{ui/icon-button
              type='close'
              class='delete'
              flat=true
              color=colors.DARK_GREY
              size=1.2
              click=deleteOrder}}
        </div>
      </div>
    </div>
  </div>
</div>

{{#each model.orderItems as |orderItem i|}}
  {{ui/order-editor/order-item-editor
      index=i
      model=orderItem
      update=updateOrderItem
      onOrderItemChange=onOrderItemChange
      save=saveOrderItem
      delete=deleteOrderItem}}
{{/each}}

<div class="col right orderTotals">
  <div class="col content">
    <span class="title">Totals</span>
    <span class="row spaceBetween baseline totalQuantity">
      <span>Total quantity: </span>
      <span class="value">{{model.totalQuantity}}</span>
    </span>
    <span class="row spaceBetween baseline totalPrice">
      <span>Total billed: </span>
      <span class="value">{{currency model.totalPrice}}</span>
    </span>
  </div>
</div>

<div class="addOrderItemContainer">
  {{#power-select
      class='search'
      placeholder='Add item'
      searchField='name'
      noMatchesMessage=noMatchesMessage
      onkeydown=(action 'onItemSearchKeyDown')
      oninput=(action 'stashItemSearch')
      selected=customAddItemResult
      options=items
      onchange=(action "createOrderItem")
      as |item|}}
        {{item.name}}
  {{/power-select}}
</div>

{{#if showCreateItemModal}}
  {{#tether-dialog}}
    {{modals/new-item
        isSold=true
        company=company
        name=itemSearchString
        cancel=(action 'cancelCreateNewItem')
        submit=(action 'requestCreateNewItem')}}
  {{/tether-dialog}}
{{/if}}
